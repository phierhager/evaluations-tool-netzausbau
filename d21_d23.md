Here are the revised deliverables **D2.1** and **D2.3**, rewritten to align strictly with the German grant proposal (*Antrag*) and your critique. I have removed all code snippets and used tables/text formatting for the technical specifications.

---

# Deliverable D2.1: GEMS System Specification & Benchmarks

**Project:** PhyLFlex (Physics-based Learning Energy Management)
**Work Package:** AP 2.1 (Konzeptionierung eines netzdienlichen GEMS)
**Responsible:** HAW Landshut (HAWL)
**Partners:** TUM, ÜZW, SAG
**Version:** 2.0 (Revised Specification)

## 1. Executive Summary

This document serves as the technical requirements specification (*Lastenheft*) for the Home Energy Management Systems (GEMS) to be developed in AP 4 (Convex), AP 5 (RL), and AP 8 (Physics-based). The system is defined as a low-cost, edge-computing solution capable of optimizing local energy flows while adhering to external signals from the Distribution System Operator (DSO).

## 2. Hardware & Efficiency Constraints

To ensure scalability across thousands of households, the GEMS algorithms must be designed for resource-constrained hardware. The development must target the **Primary Reference**, with the **Secondary Reference** serving as an efficiency benchmark for the "Low-Cost" requirement.

### 2.1 Reference Hardware Targets

| Feature | Primary Target (Edge Controller) | Secondary Target (Microcontroller Benchmark) |
| --- | --- | --- |
| **Device Model** | Raspberry Pi 4 (or equivalent Industrial Edge PC) | Arduino Portenta H7 / ESP32 |
| **OS Environment** | Linux (Dockerized Containers) | Bare Metal / RTOS |
| **Max RAM Usage** | < 512 MB | < 2 MB (Stretch Goal) |
| **Inference Time** | < 60 seconds (per 15-min interval) | < 5 seconds |
| **Power Draw** | < 5 Watts | < 1 Watt |

### 2.2 Functional Architecture

To ensure comparability between the different algorithmic approaches (Convex vs. RL), the system utilizes a strict modular design:

1. **Input Layer (Data Handler):** Aggregates data from Smart Meter Gateways (iMSys), PV inverters, and Heat Pumps via Modbus/EEBUS. It acts as a privacy filter, ensuring raw user behavior data never leaves the device.
2. **Core Layer (The Optimizer):** This is the interchangeable module where AP 4, AP 5, and AP 8 plug in their specific algorithms. The input is the system state (SoC, Temp); the output is the control schedule.
3. **Output Layer (Actuator Bridge):** Translates the schedule into device-specific commands. Crucially, this layer contains a "Safety Override" that immediately throttles loads if a §14a Emergency Signal is received, bypassing the optimizer if necessary.

## 3. Definition of Test Cases (Szenarien)

Four standardized scenarios are defined to evaluate the GEMS. These scenarios cover the conflicting goals of user autonomy vs. grid stability.

* **Scenario A: The Island Optimizer (Baseline)**
* **Focus:** Self-sufficiency.
* **Description:** The GEMS optimizes purely for the maximize usage of own PV generation. No external communication with the grid or neighbors takes place. This serves as the baseline for evaluating efficiency gains.


* **Scenario B: The P2P Community**
* **Focus:** Local Energy Sharing.
* **Description:** Buildings exchange data regarding surplus generation. House A (PV surplus) virtually shares energy with House B (Heat Pump demand).
* **Metric:** Reduction of total community import/export at the transformer point.


* **Scenario C: Grid-Constrained Operation (§14a EnWG)**
* **Focus:** Grid Stability & Compliance.
* **Description:** The DSO sends a dynamic capacity limit (e.g., "Max Import: 4.2 kW") to the GEMS. The system must throttle flexible loads (EVs, Heat Pumps) while keeping inflexible loads (Lighting, Cooking) running.
* **Success Criteria:** Zero violations of the power limit signal.


* **Scenario D: Price-Driven Operation (§41a EnWG)**
* **Focus:** Economic Optimization.
* **Description:** The GEMS receives dynamic electricity prices (e.g., Spot Market or Time-of-Use). It shifts heavy loads to cheap hours.
* **Risk to Assess:** Synchronization effects (Avalanche effect) where all households turn on simultaneously, potentially causing grid congestion.



---

# Deliverable D2.3: Grid Evaluation Suite & Measures Catalog

**Project:** PhyLFlex
**Work Package:** AP 2.2 (Konzept eines Analyse-Tools)
**Responsible:** HAW Landshut (HAWL)
**Partners:** TUM, ÜZW, SAG
**Version:** 2.0 (Revised Concept)

## 1. Executive Summary

This document defines the concept for the **Grid Evaluation Tool**. This tool acts as the "Economic Arbiter" between the conflicting interests of the Grid Operator (DSO) and the Energy Supplier/Consumer.

The tool does not control the grid; it *audits* the grid simulation. It takes the physical results (voltages, loads) and applies a rigorous **Cost-Benefit Analysis** to determine if a specific flexibility measure is economically viable compared to traditional grid expansion.

## 2. Catalog of Measures (Maßnahmenkatalog)

The following specific interventions are defined for evaluation within the tool. These map directly to the regulatory requirements mentioned in the grant proposal.

### Category A: Market-Side Measures (The "Cause")

These measures represent incentives sent to consumers to optimize their costs.

* **Measure A1: Dynamic Tariffs (§41a EnWG):** The GEMS receives a price vector derived from the EPEX Spot market.
* **Measure A2: Variable Grid Fees (§14a Module 3):** Reduced grid fees in exchange for allowing external control.

### Category B: Grid-Side Measures (The "Solution")

These measures are the DSO's reaction to grid stress caused by consumers.

* **Measure B1: Curative Control (Dimming):** The temporary reduction of power to steerable assets (SteuVE) to prevent immediate overload.
* **Measure B2: Conventional Reinforcement:** The physical replacement of assets (e.g., replacing a 400 kVA transformer with a 630 kVA unit, or laying parallel cables).

## 3. Evaluation Logic: The Cost Balancing Model

The core function of the Evaluation Tool is to calculate the **Total System Cost** for each scenario. It compares the "Iron Investment" (CAPEX) against the "Flexibility Compensation" (OPEX).

### 3.1 Cost Component: Virtual CAPEX (Grid Expansion)

If the simulation shows voltage violations (< 207V) or thermal overloads (> 100% usage) that cannot be solved by software:

* **Calculation:** The tool identifies the specific cable segments and transformer nodes that failed.
* **Formula:** (Length of Overloaded Cable in km * Cost per km) + (Cost of Transformer Upgrade).
* **Outcome:** This represents the cost of "Doing Nothing" regarding flexibility.

### 3.2 Cost Component: Intervention OPEX (Curtailment)

If the grid remains stable because the GEMS was forced to throttle loads (Scenario C):

* **Calculation:** The tool sums the total energy (kWh) that was requested by the user but denied by the grid.
* **Formula:** Total Curtailed Energy (kWh) * Penalty Cost (€/kWh).
* **Outcome:** This represents the economic loss of comfort or value to the user.

## 4. Interface Specification: The "Fact Sheet"

To ensure the Evaluation Tool is objective, it requires a standardized input format from the Grid Simulation (AP 3). This separates the *Physics* (Simulation) from the *Economics* (Evaluation).

The Grid Simulation must export a dataset containing the following fields for every 15-minute timestep:

| Field Name | Description | Unit |
| --- | --- | --- |
| **Timestamp** | ISO 8601 Date/Time string. | Time |
| **Grid Status** | Categorical flag (OK / WARNING / CRITICAL). | String |
| **Min Voltage** | The lowest voltage recorded at any node in the cluster. | Volts (V) |
| **Trafo Load** | The peak utilization percentage of the local transformer. | Percent (%) |
| **Cable Failures** | Total length of cables exceeding thermal limits. | Kilometers (km) |
| **Curtailed Energy** | Amount of energy suppressed via §14a interventions. | kWh |

## 5. Synthesis: The Decision Matrix

The final output of D2.3 is a decision matrix that answers the project's core question:

* **Question:** Does the GEMS (AP 4/5/8) save money compared to traditional copper expansion?
* **Method:**
1. Calculate **Cost_Classic** (Scenario A with full Grid Expansion CAPEX).
2. Calculate **Cost_Smart** (Scenario C/D with GEMS + Curtailment OPEX).


* **Success Indicator:** If **Cost_Smart < Cost_Classic**, the GEMS concept is validated as economically viable for the partner ÜZW.